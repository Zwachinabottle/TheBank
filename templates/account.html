<!DOCTYPE html>
<html lang="en" class="{{ session.get('theme', 'dark') }}-mode">
<head>
<meta charset="UTF-8">
<title>Account Dashboard</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
    .right-loan-btn {
  margin-top: 20px;
  padding: 14px 22px;
  border-radius: 14px;
  background: var(--brand);
  color: white;
  border: none;
  font-weight: 700;
  cursor: pointer;
  transition: 0.2s ease;
  width: 80%;
}

.right-loan-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 22px rgba(36,191,240,0.35);
}
    @font-face {
  font-family: "DollarFont";
  src: url("{{ url_for('static', filename='fonts/MyCustomFont.ttf') }}") format("truetype");
}
.dollar {
  font-family: "DollarFont", Inter, system-ui;
}
    /* LOGOUT FLOATING BUTTON */
.logout-fab {
  position: fixed;
  bottom: 24px;
  left: 24px;
  padding: 12px 20px;
  border-radius: 999px;
  background: var(--bg2);
  border: 1px solid var(--border);
  color: var(--text);
  font-weight: 600;
  cursor: pointer;
  text-decoration: none;
  transition: 0.2s ease;
  z-index: 1500;
}

.logout-fab:hover {
  background: rgba(36,191,240,0.18);
  border-color: var(--brand);
  transform: translateY(-2px);
}
:root {
  --brand:#24bff0;
  --bg:#11191c;
  --bg2:#1a2c32;
  --bg3:#182429;
  --text:#d7e6eb;
  --text-muted:#9db6bd;
  --input-bg:#243238;
  --border:#2e4b52;
  --rounded:14px;
}

.light-mode {
  --bg:#e7eef2;
  --bg2:#f5f8fa;
  --bg3:#ffffff;
  --text:#1b1f21;
  --text-muted:#556166;
  --input-bg:#ecf1f3;
  --border:#c7d2d6;
}

body {
  margin:0;
  height:100vh;
  display:flex;
  font-family: Inter, system-ui;
  background:var(--bg);
  color:var(--text);
  overflow:hidden;
}

/* SIDE BANNERS */
.side-banner {
  flex:1;
  background:var(--bg2);
  border-right:1px solid var(--border);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:20px;
}

.side-banner:last-child {
  border-right:none;
  border-left:1px solid var(--border);
}

/* CENTER COLUMN */
.center-column {
  flex:5;
  max-width:1200px;
  margin:auto;
  padding:35px;
  background:var(--bg3);
  border-left:1px solid var(--border);
  border-right:1px solid var(--border);
  overflow-y:auto;
}

h1 {
  text-align:center;
  margin:10px 0 30px;
  font-size:32px;
}

h2 { margin-top:0 }

/* INFO CARDS */
.info-row {
  display:flex;
  gap:20px;
}

.info-card {
  flex:1;
  background:var(--bg2);
  padding:20px;
  border-radius:var(--rounded);
  border:1px solid var(--border);
  box-shadow:0 6px 20px rgba(0,0,0,0.18);
}

/* LOANS */
.loan-card {
  margin-top:25px;
}

/* TRANSACTIONS */
.transaction-box {
  margin-top:25px;
  background:var(--bg2);
  padding:20px;
  border-radius:var(--rounded);
  border:1px solid var(--border);
  box-shadow:0 6px 20px rgba(0,0,0,0.18);
}

.history-box {
  max-height:300px;
  overflow-y:auto;
}

table {
  width:100%;
  border-spacing:0 10px;
}

td {
  padding:4px;
}

/* MODAL */
.modal-overlay {
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.65);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:2000;
}

.modal-overlay.active {
  display:flex;
}

.modal {
  background:var(--bg3);
  padding:28px;
  border-radius:16px;
  width:100%;
  max-width:420px;
  border:1px solid var(--border);
}

.modal input, .modal button {
  width:100%;
  padding:12px;
  margin-top:12px;
  border-radius:10px;
}

.modal input {
  background:var(--input-bg);
  border:1px solid var(--border);
  color:var(--text);
}

.modal button {
  border:none;
  background:var(--brand);
  color:white;
  font-weight:700;
  cursor:pointer;
}

.modal-close {
  background:none;
  border:1px solid var(--border);
  margin-top:12px;
}

/* FLOATING BUTTONS */
.floating-btn {
  position:fixed;
  bottom:24px;
  left:50%;
  transform:translateX(-50%);
  padding:14px 24px;
  border-radius:999px;
  background:var(--brand);
  color:white;
  border:none;
  font-weight:700;
  cursor:pointer;
  z-index:1500;
}
.floating-btn:hover {
  box-shadow:0 8px 22px rgba(36,191,240,0.35);
  transform:translateX(-50%) translateY(-2px);
}

.teacher-fab {
  position:fixed;
  bottom:24px;
  right:24px;
  width:54px;
  height:54px;
  border-radius:50%;
  background:var(--bg2);
  border:1px solid var(--border);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:22px;
  color:var(--text);
  text-decoration:none;
  z-index:1500;
}
.teacher-fab:hover {
  background: rgba(36,191,240,0.18);
  border-color: var(--brand);
  transform: translateY(-2px);
}
</style>
</head>

<body>
    <a href="{{ url_for('logout') }}" class="logout-fab">
  Logout
</a>
<div class="side-banner">
  <img src="{{ url_for('static', filename='ahs_logo.png') }}" style="height:300px">
</div>

<div class="center-column">

<h1>Hey, {{ username }}!</h1>

<div class="info-row">
  <div class="info-card">
    <h2>Available Balance</h2>
   <p style="font-size:26px;font-weight:700">
  <span class="dollar">$</span>{{ "%.2f"|format(balance) }}
</p>
  </div>

  <div class="info-card">
    <h2>Account Details</h2>
    <p>Card Number: <i>Coming soon</i></p>
    <p>PIN: <i>Coming soon</i></p>
  </div>
</div>

<div class="info-card loan-card">
  <h2>Your Loans</h2>
  {% if loans %}
    {% for loan in loans %}
      <p>Amount: <b>${{ "%.2f"|format(loan.amount) }}</b><br>
      Remaining: <b>${{ "%.2f"|format(loan.remaining) }}</b></p>
    {% endfor %}
  {% else %}
    <p style="color:var(--text-muted)">No active loans</p>
  {% endif %}
</div>

<div class="transaction-box">
<h2>Past Transactions</h2>
<div class="history-box">
<table>
{% for t in transactions %}
<tr>
<td>
<b>
{% if t.Sender == username %}
Sent to {{ t.Receiver }}
{% else %}
Received from {{ t.Sender }}
{% endif %}
</b><br>
<span style="font-size:13px;color:var(--text-muted)">
{{ t.Date }} {% if t.Comment %}â€” "{{ t.Comment }}"{% endif %}
</span>
</td>
<td style="text-align:right;font-weight:700">
${{ "%.2f"|format(t.Amount) }}
</td>
</tr>
{% endfor %}
</table>
</div>
</div>

</div>

<div class="side-banner">
  <img src="{{ url_for('static', filename='banner.png') }}" style="height:400px">
  <button
    class="right-loan-btn"
    onclick="window.location.href='{{ url_for('loan') }}'">
    Apply for a Loan
  </button>
</div>


<!-- MODAL -->
<div class="modal-overlay" id="transactionModal">
  <div class="modal">
    <h2>Make a Transaction</h2>
    <form method="POST" action="{{ url_for('transfer') }}">
      <input name="receiver" placeholder="Receiver Username" required>
      <input name="amount" type="number" placeholder="Amount" required>
      <input name="comment" placeholder="Comment (optional)">
      <button type="submit">Send</button>
    </form>
    <button class="modal-close" onclick="closeTransaction()">Cancel</button>
  </div>
</div>

<button class="floating-btn" onclick="openTransaction()">New Transaction</button>
<a href="/teachertools" class="teacher-fab">ðŸ› </a>

<script>
function openTransaction(){
  document.getElementById("transactionModal").classList.add("active");
}
function closeTransaction(){
  document.getElementById("transactionModal").classList.remove("active");
}
</script>

</body>
</html>
